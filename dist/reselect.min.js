/*!
 * reselect
 * https://github.com/alexcheuk/Reselect
 * Version: 0.0.1 - 2016-03-29T23:58:53.471Z
 * License: MIT
 */
!function(){"use strict";var e=angular.module("Reselect",["reselect.templates"]);e.value("reselectDefaultOptions",{placeholderTemplate:function(){return"Select an option"},selectionTemplate:function(e){return e.text}}).directive("reselect",[function(){return{restrict:"AE",templateUrl:"templates/reselect.directive.tpl.html",require:["^reselect","^ngModel"],transclude:!0,replace:!0,scope:{ngModel:"=",reselectOptions:"="},compile:function(e,t,n){return function(e,t){var o=n(e,function(e){t.append(e[1])}).detach();angular.element(t[0].querySelectorAll(".reselect-dropdown")).append(o)}},controllerAs:"$reselect",controller:["$scope","$element","reselectDefaultOptions","$timeout",function(e,t,n){var o=this,i=t.controller("ngModel");return o.options=angular.extend({},e.reselectOptions,n),o.value=null,o.opened=!1,o.rendered_placeholder=null,o.renderPlaceholder=function(){o.rendered_placeholder=o.options.placeholderTemplate()},o.rendered_selection=null,o.renderSelection=function(e){o.rendered_selection=o.options.selectionTemplate(e)},o.selectValue=function(e){i.$setViewValue(e),o.value=e,o.renderSelection(o.value),o.hideDropdown()},o.parsedOptions=null,o.choices=[],o.toggleDropdown=function(){o.opened?o.hideDropdown():o.showDropdown()},o.showDropdown=function(){o.opened=!0},o.hideDropdown=function(){o.opened=!1},o.initialize=function(){o.renderPlaceholder()},o.initialize(),o}]}}]),e.value("reselectChoicesOptions",{}),e.service("LazyScroller",["LazyContainer","$compile",function(e,t){var n=function(e,t){var n=this;n.options=angular.extend({},t),n.$scope=e,n.$container=n.options.container,n.$list=n.options.list,n.choices=[],n.lazyContainers=[],n.numLazyContainers=Math.ceil(n.options.listHeight/n.options.choiceHeight)+2,n.lastCheck=null,n.lastScrollTop=null};return n.prototype.renderContainer=function(){var e=this,t=e.choices.length*e.options.choiceHeight,n=t>e.options.listHeight?e.options.listHeight:t;e.$container.css("height",(n||32)+"px"),e.$list.css("height",t+"px")},n.prototype.bindScroll=function(){var e=this;e.$container.on("scroll",function(){window.requestAnimationFrame(function(){e._calculateLazyRender()})})},n.prototype._shouldRender=function(e){var t=this;return"number"==typeof t.lastCheck&&e<=t.lastCheck+(t.options.choiceHeight-t.lastCheck%t.options.choiceHeight)&&e>=t.lastCheck-t.lastCheck%t.options.choiceHeight},n.prototype._calculateLazyRender=function(e){var t=this,n=t.$container[0].scrollTop;if(t.lastScrollTop=n,e===!0||!t._shouldRender()){var o=[],i=[];angular.forEach(t.lazyContainers,function(e){var r=e.index*t.options.choiceHeight||0;null===e.index||r<n-t.options.choiceHeight||r>n+t.options.listHeight+t.options.choiceHeight?(e.element.addClass("inactive").removeClass("active"),i.push(e)):(e.element.addClass("active").removeClass("inactive"),o.push(e))});var r=o.map(function(e){return e.index}),c=Math.floor(n/t.options.choiceHeight);c=0>c?0:c;var l=Math.ceil((n+t.options.listHeight)/t.options.choiceHeight);l=l>=t.choices.length?t.choices.length:l;for(var s=c;l>s;s++)if(!(r.indexOf(s)>=0)){var a=i.shift();a&&(a.element.addClass("active").removeClass("inactive"),a.index=s,a.render(t.options.choiceHeight),angular.extend(a.scope,{$containerId:a.containerId,$index:s}),angular.extend(a.scope.$choice,t.choices[s]))}t.$scope.$evalAsync(),t.lastCheck=Math.floor(n/t.options.choiceHeight)*t.options.choiceHeight}},n.prototype.initialize=function(n){for(var o=this,i=0;i<o.numLazyContainers;i++){var r=n.clone(),c=o.$scope.$new();c.$choice={},t(r)(c),o.lazyContainers.push(new e({containerId:i,element:r,scope:c})),o.$list.append(r)}o.bindScroll()},n}]),e.service("LazyContainer",[function(){var e=function(e){var t=this;t.containerId=null,t.element=null,t.index=null,t.scope=null,angular.extend(t,e)};return e.prototype.render=function(e){var t=this;(t.element||null!==t.index)&&t.element.css("top",t.index*e+"px")},e}]),e.directive("reselectChoices",["ChoiceParser","$compile","LazyScroller","LazyContainer",function(e,t,n){return{restrict:"AE",templateUrl:"templates/reselect.options.directive.tpl.html",require:["reselectChoices","^reselect"],transclude:!0,replace:!0,compile:function(t,n){if(!n.options)throw new Error('"reselect-options" directive requires the [options] attribute.');return function(t,n,o,i,r){var c=i[0],l=i[1];l.parsedOptions=e.parse(o.options),l.choices=l.parsedOptions.source(t.$parent)||[],r(function(e){c.CHOICE_TEMPLATE.append(e)}),c.LazyDropdown.initialize(c.CHOICE_TEMPLATE),c.LazyDropdown.renderContainer()}},controllerAs:"$options",controller:["$scope","$element","$attrs",function(e,t,o){var i=this;i.element=t[0],i.$container=angular.element(i.element.querySelectorAll(".reselect-options-container")),i.$list=angular.element(i.element.querySelectorAll(".reselect-options-list")),i.choiceHeight=36,i.listHeight=300,i.CHOICE_TEMPLATE=angular.element('<li class="reselect-option reselect-option-choice" ng-click="$options._selectChoice($containerId)"></li>'),i.CHOICE_TEMPLATE.attr("ng-class","{'reselect-option-choice--highlight' : $options.activeIndex === $index }"),i.CHOICE_TEMPLATE.attr("ng-mouseenter","$options.activeIndex = $index"),i.CHOICE_TEMPLATE.attr("ng-mouseleave","$options.activeIndex = null");var r=t.controller("reselect");e.$watchCollection(function(){return r.parsedOptions.source(e.$parent)},function(e){r.choices=e||[],i.render(r.choices)}),i.LazyDropdown=new n(e,{container:i.$container,list:i.$list,choiceHeight:36,listHeight:300}),i.activeIndex=null,i._setActiveIndex=function(e){i.activeIndex=e},i._selectChoice=function(e){var t=angular.copy(i.LazyDropdown.lazyContainers[e].scope.$eval(o.value));r.selectValue(t)},i.$parent=t.parent(),i.render=function(e){i.LazyDropdown.choices=e,i.LazyDropdown.renderContainer(),i.LazyDropdown._calculateLazyRender(!0)}}]}}]),e.service("ChoiceParser",["$parse",function(e){var t=this;t.parse=function(t){{var n;/\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)/.test(t)}return n=t.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(([\w\.]+)?\s*(|\s*[\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),{itemName:n[4]||n[2],keyName:n[3],source:e(n[3]?n[6]:n[5]),sourceName:n[6],filters:n[7],trackByExp:n[8],modelMapper:e(n[1]||n[4]||n[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}}}]),angular.module("reselect.templates",[]).run(["$templateCache",function(e){e.put("templates/lazy-container.tpl.html",'<div class="reselect-dropdown"><div class="reselect-options-container"><div class="reselect-option reselect-option-choice" ng-show="!$reselect.choices.length">No Options</div><ul class="reselect-options-list"></ul></div></div>'),e.put("templates/reselect.choice.tpl.html",""),e.put("templates/reselect.directive.tpl.html",'<div class="reselect-container reselect"><input type="hidden" value="{{ngModel}}"><div class="reselect-selection" ng-class="{\'reselect-selection--active\' : $reselect.opened }" ng-click="$reselect.toggleDropdown()"><div class="reselect-rendered reselect-rendered-selection" ng-if="$reselect.value" ng-bind="$reselect.rendered_selection"></div><div class="reselect-rendered reselect-rendered-placeholder" ng-if="!$reselect.value" ng-bind="$reselect.rendered_placeholder"></div><div class="reselect-arrow-container"><div class="reselect-arrow"></div></div></div><div class="reselect-dropdown" ng-class="{\'reselect-dropdown--opened\' : $reselect.opened }"></div></div>'),e.put("templates/reselect.options.directive.tpl.html",'<div class="reselect-choices"><div class="reselect-options-container"><div class="reselect-option reselect-option-choice" ng-show="!$reselect.choices.length">No Options</div><ul class="reselect-options-list"></ul></div></div>')}])}();