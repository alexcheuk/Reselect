/*!
 * reselect
 * https://github.com/alexcheuk/Reselect
 * Version: 0.0.1 - 2016-03-31T01:41:43.897Z
 * License: MIT
 */
!function(){"use strict";var e=angular.module("Reselect",["reselect.templates"]);e.value("reselectDefaultOptions",{placeholderTemplate:function(){return"Select an option"},selectionTemplate:angular.element('<div><span ng-bind="$selection.text"></span></div>')}).directive("reselect",["$compile",function(e){return{restrict:"AE",templateUrl:"templates/reselect.directive.tpl.html",require:["^reselect","^ngModel"],transclude:!0,replace:!0,scope:{ngModel:"=",reselectOptions:"="},compile:function(t,n,o){return function(t,n,i,c){var l=c[0],r=null;o(t,function(e){r=e,n.append(e)}).detach(),r=angular.element("<div>").append(r);var s=r[0].querySelectorAll(".reselect-choices, [reselect-choices]"),a=r[0].querySelectorAll(".reselect-selection, [reselect-selection]");a=a.length?a:l.options.selectionTemplate.clone(),angular.element(n[0].querySelectorAll(".reselect-dropdown")).append(s),angular.element(n[0].querySelectorAll(".reselect-rendered-selection")).append(a),e(a)(l.selection_scope)}},controllerAs:"$reselect",controller:["$scope","$element","reselectDefaultOptions","$timeout",function(e,t,n){var o=this,i=t.controller("ngModel");return o.options=angular.extend({},e.reselectOptions,n),o.value=null,o.opened=!1,o.rendered_placeholder=null,o.renderPlaceholder=function(){o.rendered_placeholder=o.options.placeholderTemplate()},o.selection_scope=e.$new(),o.selection_scope.$selection=null,o.rendered_selection=null,o.renderSelection=function(e){o.selection_scope.$selection=e},o.selectValue=function(e){i.$setViewValue(e),o.value=e,o.renderSelection(o.value),o.hideDropdown()},o.parsedOptions=null,o.choices=[],o.toggleDropdown=function(){o.opened?o.hideDropdown():o.showDropdown()},o.showDropdown=function(){o.opened=!0},o.hideDropdown=function(){o.opened=!1},o.initialize=function(){o.renderPlaceholder()},o.initialize(),o}]}}]),e.service("LazyScroller",["LazyContainer","$compile",function(e,t){var n=function(e,t){var n=this;n.options=angular.extend({},t),n.$scope=e,n.$container=n.options.container,n.$list=n.options.list,n.choices=[],n.lazyContainers=[],n.numLazyContainers=Math.ceil(n.options.listHeight/n.options.choiceHeight)+2,n.lastCheck=null,n.lastScrollTop=null};return n.prototype.renderContainer=function(){var e=this,t=e.choices.length*e.options.choiceHeight,n=t>e.options.listHeight?e.options.listHeight:t;e.$container.css("height",(n||e.options.choiceHeight)+2+"px"),e.$list.css("height",t+"px")},n.prototype.bindScroll=function(){var e=this;e.$container.on("scroll",function(){window.requestAnimationFrame(function(){e._calculateLazyRender()})})},n.prototype._shouldRender=function(e){var t=this;return"number"==typeof t.lastCheck&&e<=t.lastCheck+(t.options.choiceHeight-t.lastCheck%t.options.choiceHeight)&&e>=t.lastCheck-t.lastCheck%t.options.choiceHeight},n.prototype._calculateLazyRender=function(e){var t=this,n=t.$container[0].scrollTop;if(t.lastScrollTop=n,e===!0||!t._shouldRender()){var o=[],i=[];angular.forEach(t.lazyContainers,function(e){var c=e.index*t.options.choiceHeight||0;null===e.index||c<n-t.options.choiceHeight||c>n+t.options.listHeight+t.options.choiceHeight?(e.element.addClass("inactive").removeClass("active"),i.push(e)):(e.element.addClass("active").removeClass("inactive"),o.push(e))});var c=o.map(function(e){return e.index}),l=Math.floor(n/t.options.choiceHeight);l=0>l?0:l;var r=Math.ceil((n+t.options.listHeight)/t.options.choiceHeight);r=r>=t.choices.length?t.choices.length:r;for(var s=l;r>s;s++)if(!(c.indexOf(s)>=0)){var a=i.shift();a&&(a.element.addClass("active").removeClass("inactive"),a.index=s,a.render(t.options.choiceHeight),angular.extend(a.scope,{$containerId:a.containerId,$index:s}),angular.extend(a.scope.$choice,t.choices[s]))}t.$scope.$evalAsync(),t.lastCheck=Math.floor(n/t.options.choiceHeight)*t.options.choiceHeight}},n.prototype.initialize=function(n){for(var o=this,i=0;i<o.numLazyContainers;i++){var c=n.clone(),l=o.$scope.$new();l.$choice={},t(c)(l),o.lazyContainers.push(new e({containerId:i,element:c,scope:l})),o.$list.append(c)}o.bindScroll()},n}]),e.service("LazyContainer",[function(){var e=function(e){var t=this;t.containerId=null,t.element=null,t.index=null,t.scope=null,angular.extend(t,e)};return e.prototype.render=function(e){var t=this;(t.element||null!==t.index)&&t.element.css("top",t.index*e+"px")},e}]),e.value("reselectChoicesOptions",{}),e.directive("reselectChoices",["ChoiceParser","$compile","LazyScroller","LazyContainer",function(e,t,n){return{restrict:"AE",templateUrl:"templates/reselect.options.directive.tpl.html",require:["reselectChoices","?^reselect"],transclude:!0,replace:!0,compile:function(e,t){return!t.options,function(e,t,n,o,i){{var c=o[0];o[1]}i(function(e){c.CHOICE_TEMPLATE.append(e)}),c.LazyDropdown.initialize(c.CHOICE_TEMPLATE),c.LazyDropdown.renderContainer()}},controllerAs:"$options",controller:["$scope","$element","$attrs","$parse","$http",function(t,o,i,c,l){var r=this;r.element=o[0],r.$container=angular.element(r.element.querySelectorAll(".reselect-options-container")),r.$list=angular.element(r.element.querySelectorAll(".reselect-options-list")),r.choiceHeight=36,r.listHeight=300,r.choices=[],r.CHOICE_TEMPLATE=angular.element('<li class="reselect-option reselect-option-choice" ng-click="$options._selectChoice($containerId)"></li>'),r.CHOICE_TEMPLATE.attr("ng-class","{'reselect-option-choice--highlight' : $options.activeIndex === $index }"),r.CHOICE_TEMPLATE.attr("ng-mouseenter","$options.activeIndex = $index"),r.CHOICE_TEMPLATE.attr("ng-mouseleave","$options.activeIndex = null");var s=o.controller("reselect");i.options?(r.parsedOptions=e.parse(i.options),t.$watchCollection(function(){return r.parsedOptions.source(t.$parent)},function(e){r.updateChoices(e),r.render(s.choices)})):i.remote&&(r.parsedOptions=c(i.remote)(t.$parent),l.get(r.parsedOptions.endpoint).then(function(e){r.updateChoices(e.data.data.children),r.render(s.choices)})),console.log(r.parsedOptions),r.updateChoices=function(e,t){e=e||[],s.choices=r.choices=t===!0?r.choices.concat(e):e},r.LazyDropdown=new n(t,{container:r.$container,list:r.$list,choiceHeight:36,listHeight:300}),r.activeIndex=null,r._setActiveIndex=function(e){r.activeIndex=e},r._selectChoice=function(e){var t=angular.copy(r.LazyDropdown.lazyContainers[e].scope.$eval(i.value));s.selectValue(t)},r.$parent=o.parent(),r.render=function(e){r.LazyDropdown.choices=e,r.LazyDropdown.renderContainer(),r.LazyDropdown._calculateLazyRender(!0)}}]}}]),e.service("ChoiceParser",["$parse",function(e){var t=this;t.parse=function(t){var n;if(n=t.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),!n)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",t);var o=n[5],i="";if(n[3]){o=n[5].replace(/(^\()|(\)$)/g,"");var c=n[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/);c&&c[1].trim()&&(i=c[1],o=o.replace(i,""))}return{itemName:n[4]||n[2],keyName:n[3],source:e(o),filters:i,trackByExp:n[6],modelMapper:e(n[1]||n[4]||n[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}}}]),angular.module("reselect.templates",[]).run(["$templateCache",function(e){e.put("templates/lazy-container.tpl.html",'<div class="reselect-dropdown"><div class="reselect-options-container"><div class="reselect-option reselect-option-choice" ng-show="!$reselect.choices.length">No Options</div><ul class="reselect-options-list"></ul></div></div>'),e.put("templates/reselect.choice.tpl.html",""),e.put("templates/reselect.directive.tpl.html",'<div class="reselect-container reselect"><input type="hidden" value="{{ngModel}}"><div class="reselect-selection" ng-class="{\'reselect-selection--active\' : $reselect.opened }" ng-click="$reselect.toggleDropdown()"><div class="reselect-rendered reselect-rendered-selection" ng-show="$reselect.value"></div><div class="reselect-rendered reselect-rendered-placeholder" ng-show="!$reselect.value" ng-bind="$reselect.rendered_placeholder"></div><div class="reselect-arrow-container"><div class="reselect-arrow"></div></div></div><div class="reselect-dropdown" ng-class="{\'reselect-dropdown--opened\' : $reselect.opened }"></div></div>'),e.put("templates/reselect.options.directive.tpl.html",'<div class="reselect-choices"><div class="reselect-options-container"><div class="reselect-option reselect-option-choice" ng-show="!$reselect.choices.length">No Options</div><ul class="reselect-options-list"></ul></div></div>')}])}();