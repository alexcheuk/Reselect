/*!
 * reselect
 * https://github.com/alexcheuk/Reselect
 * Version: 0.0.1 - 2016-06-07T23:55:16.192Z
 * License: MIT
 */
(function(){"use strict";var e=angular.module("Reselect",["reselect.templates"]);e.service("ReselectDataAdapter",["$q",function(e){var t=function(){this.data=[]};return t.prototype.observe=function(){console.error("Not implemented")},t.prototype.prepareGetData=function(){},t.prototype.getData=function(){var t,n=e.defer();return t=this.data,n.resolve({data:t}),n.promise},t.prototype.updateData=function(e){return this.data=e,this.data},t.prototype.init=function(){this.observe(this.updateData.bind(this))},t}]),e.service("ReselectAjaxDataAdapter",["$http",function(e){var t=function(e,t){this.data=[],this.page=1,this.pagination={},this.parsedOptions=t,this.options=angular.extend({params:function(e){return e}},e)};return t.prototype.observe=function(){},t.prototype.prepareGetData=function(){},t.prototype.getData=function(t){var n,o=this,i={page:this.page,search_term:t},c=this.options.params(i,o.pagination);return n="function"==typeof this.options.endpoint?this.options.endpoint(i,o.pagination):this.options.endpoint,e.get(n,{params:c}).then(function(e){return o.parsedOptions.source({$remote:e.data})}).then(this.options.onData).then(function(e){return e.pagination?(o.pagination=e.pagination,e.pagination.more&&(o.page+=1)):o.pagination=null,e})},t.prototype.updateData=function(e,t){return this.data=t===!0?this.data.concat(e):e,this.data},t.prototype.init=function(){},t}]),e.value("reselectDefaultOptions",{allowClear:!1}).directive("reselect",["$compile",function(){return{restrict:"AE",templateUrl:"templates/reselect.directive.tpl.html",require:["^reselect","^ngModel"],transclude:!0,replace:!0,scope:!0,link:function(e,t,n,o,i){function c(e,n,o,i,c){var a=r[0].querySelectorAll("."+e+",["+e+"],"+e);1===a.length?c===!0?angular.element(t[0].querySelector("."+e)).replaceWith(a):angular.element(t[0].querySelectorAll(n)).append(a):a=t[0].querySelectorAll("."+e),o&&i&&(s.transcludeCtrls[o]=angular.element(a).controller(i),s.transcludeScopes[o]=angular.element(a).scope())}var s=o[0],r=null;i(e,function(e){r=e,t.append(e)}).detach(),r=angular.element("<div>").append(r),c("reselect-choices",".reselect-dropdown","$ReselectChoice","reselectChoices"),c("reselect-no-choice",".reselect-empty-container",null,null,!0),c("reselect-placeholder",".reselect-rendered-placeholder","$ReselectPlaceholder","reselectPlaceholder",!0),c("reselect-selection",".reselect-rendered-selection","$ReselectSelection","reselectSelection",!0);var a=r[0].querySelectorAll(".reselect-choice, [reselect-choice], reselect-choice");s.transcludeCtrls.$ReselectChoice.registerChoices(a)},controllerAs:"$reselect",controller:["$scope","$element","$attrs","$parse","reselectDefaultOptions","$timeout","KEYS",function(e,t,n,o,i,c,s){function r(n){t[0].contains(n.target)||(e.$safeApply(function(){a.hideDropdown(!0)}),angular.element(document).off("click",r))}var a=this,l=t.controller("ngModel");return a.options=angular.extend({},i,o(n.reselectOptions)(e)),angular.forEach(i,function(t,i){angular.isDefined(n[i])&&(a.options[i]=o(n[i])(e))}),a.value=null,a.opened=!1,a.transcludeCtrls={},a.transcludeScopes={},a.parsedChoices=null,a.DataAdapter=null,a.search_term="",a.isDisabled=!1,a.isFetching=!1,a.selection_scope={},a.selection_scope.$selection=null,a.renderSelection=function(t,n){a.selection_scope.$selection=t,a.selection_scope.$choice=n,e.$broadcast("reselect.renderselection",a.selection_scope)},a.clearValue=function(){a.selectValue(void 0,void 0)},a.selectValue=function(e,t){l.$setViewValue(e),a.value=e,a.renderSelection(a.value,t||e),a.opened&&a.hideDropdown()},a.clearSearch=function(){a.search_term=""},l.$render=function(){function e(e){var t={};return t[a.parsedOptions.itemName]=e,a.parsedOptions.modelMapper(t)}var t,n=l.$viewValue;if(angular.isDefined(n)){{var o,i,c=a.DataAdapter.data;a.parsedOptions.trackByExp}if(c&&c.length>=0)for(var s=0;s<c.length;s++)if(angular.isDefined(c[s])&&(o=e(c[s]),i=n,o===i)){t=c[s];break}}if(t)a.selectValue(l.$viewValue,t);else if(a.options.allowInvalid===!0)a.selectValue(n);else if(a.options.allowInvalid&&"function"==typeof a.options.allowInvalid){var r=function(t){void 0!==t?a.selectValue(e(t),t):a.selectValue(void 0)};a.options.allowInvalid(n,r)}else a.selectValue(void 0)},a.parsedOptions=null,a.choices=[],a.handleKeyDown=function(t){var n=t.which;a.opened?(n===s.ESC||n===s.TAB)&&(a.hideDropdown(),t.preventDefault()):n===s.ENTER||n===s.SPACE||n===s.UP||n===s.DOWN?(a.showDropdown(),t.preventDefault()):n===s.ESC&&(e.$emit("reselect.input.blur"),t.preventDefault())},a.toggleDropdown=function(){a.opened?a.hideDropdown():a.showDropdown()},a.showDropdown=function(){a.opened=!0,a.transcludeCtrls.$ReselectChoice.getData(!0),e.$emit("reselect.search.focus"),angular.element(document).on("click",r)},a.hideDropdown=function(t){a.opened=!1,a.clearSearch(),t||e.$emit("reselect.input.focus")},a.bindEventListeners=function(){e.$on("reselect.hide",function(){e.$safeApply(function(){a.hideDropdown()})})},a.initialize=function(){a.bindEventListeners()},a.initialize(),a}]}}]),e.service("LazyScroller",["LazyContainer","$compile",function(e,t){var n={scopeName:"$choice"},o=function(e,t){var o=this;o.options=angular.extend({},n,t),o.$scope=e,o.$container=o.options.container,o.$list=o.options.list,o.choices=[],o.lazyContainers=[],o.numLazyContainers=Math.ceil(o.options.listHeight/o.options.choiceHeight)+2,o.lastCheck=null,o.lastScrollTop=null};return o.prototype.renderContainer=function(){var e=this,t=e.choices.length*e.options.choiceHeight,n=t>e.options.listHeight?e.options.listHeight:t;return e.$container.css("height",(n||e.options.choiceHeight)+"px"),e.$list.css("height",t+"px"),{choiceHeight:t,containerHeight:n}},o.prototype.bindScroll=function(){var e=this;e.$container.on("scroll",function(){window.requestAnimationFrame(function(){e._calculateLazyRender(),e.$scope.$apply()})})},o.prototype._shouldRender=function(e){var t=this;return!("number"==typeof t.lastCheck&&e<=t.lastCheck+(t.options.choiceHeight-t.lastCheck%t.options.choiceHeight)&&e>=t.lastCheck-t.lastCheck%t.options.choiceHeight)},o.prototype._calculateLazyRender=function(e){var t=this,n=e===!0?t.lastScrollTop:t.$container[0].scrollTop;if(t.lastScrollTop=n,e===!0||t._shouldRender(n)){var o=[],i=[];angular.forEach(t.lazyContainers,function(c){var s=c.index*t.options.choiceHeight||0;e===!0&&(c.index=null),null===c.index||s<n-t.options.choiceHeight||s>n+t.options.listHeight+t.options.choiceHeight?(c.element.addClass("inactive").removeClass("active"),i.push(c)):(c.element.addClass("active").removeClass("inactive"),o.push(c))});var c=o.map(function(e){return e.index}),s=Math.floor(n/t.options.choiceHeight);s=0>s?0:s;var r=Math.ceil((n+t.options.listHeight)/t.options.choiceHeight);r=r>=t.choices.length?t.choices.length:r;for(var a=s;r>a;a++)if(!(c.indexOf(a)>=0)){var l=i.shift();l&&(l.element.addClass("active").removeClass("inactive"),l.index=a,l.render(t.options.choiceHeight),angular.extend(l.scope,{$containerId:l.containerId,$index:a,cssClass:t.choices[a]?t.choices[a].class:""}),t.choices[a]&&t.choices[a].$sticky===!0?(l.scope[t.options.scopeName]=t.choices[a].text,l.scope.$onClick=t.choices[a].onClick,l.scope.$sticky=t.choices[a].$sticky,l.scope.$stickyContent=t.choices[a].$stickyContent):(l.scope[t.options.scopeName]=t.choices[a],l.scope.$sticky=!1))}t.lastCheck=Math.floor(n/t.options.choiceHeight)*t.options.choiceHeight}},o.prototype.initialize=function(n){for(var o=this,i=0;i<o.numLazyContainers;i++){var c=n.clone(),s=o.$scope.$new();s.$options=o.$scope.$options,s[o.options.scopeName]={},t(c)(s),o.lazyContainers.push(new e({containerId:i,element:c,scope:s})),o.$list.append(c)}o.bindScroll()},o}]),e.service("LazyContainer",[function(){var e=function(e){var t=this;t.containerId=null,t.element=null,t.index=null,t.scope=null,angular.extend(t,e)};return e.prototype.render=function(e){var t=this;(t.element||null!==t.index)&&t.element.css("top",t.index*e+"px")},e}]),e.directive("reselectNoChoice",function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"templates/reselect-no-choice.directive.tpl.html"}}),e.value("reselectChoicesOptions",{noOptionsText:"No Options",choiceHeight:36,listHeight:300}),e.directive("triggerAtBottom",["$parse","ReselectUtils",function(e,t){var n=function(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight};return{restrict:"A",link:function(o,i,c){function s(){(n(i)+i[0].scrollTop!==0||0!==i[0].scrollHeight)&&(n(i)+i[0].scrollTop>=i[0].scrollHeight-30&&a(),r=!1)}var r=!1,a=t.debounce(function(){e(c.triggerAtBottom)(o)},150);i.on("scroll",function(){r||(window.requestAnimationFrame?window.requestAnimationFrame(s):setTimeout(s,300),r=!0)}),s()}}}]),e.directive("reselectChoices",["ChoiceParser","$compile","LazyScroller","LazyContainer","ReselectUtils","reselectChoicesOptions",function(e,t,n,o,i,c){return{restrict:"AE",templateUrl:"templates/reselect.options.directive.tpl.html",require:["reselectChoices","?^reselect"],transclude:!0,replace:!0,compile:function(e,t){return t.options?function(e,t,n,o,i){{var c=o[0];o[1]}i(function(e){angular.element(c.CHOICE_TEMPLATE[0].querySelectorAll(".reselect-option-choice-container")).append(e)}),c.LazyDropdown.initialize(c.CHOICE_TEMPLATE),c.LazyDropdown.renderContainer()}:(console.warn("[reselect-options] directive requires the [options] attribute."),void 0)},controllerAs:"$options",controller:["$scope","$element","$attrs","$parse","$http","$timeout","ReselectDataAdapter","ReselectAjaxDataAdapter","KEYS",function(t,o,s,r,a,l,p,d,u){var h=o.controller("reselect"),v=this;v.options=angular.extend({},c,r(s.reselectChoices)(t)||{}),v.options.noOptionsText=s.noOptionsText||v.options.noOptionsText,v.element=o[0],v.$container=angular.element(v.element.querySelectorAll(".reselect-options-container")),v.$list=angular.element(v.element.querySelectorAll(".reselect-options-list")),v.$search=angular.element(v.element.querySelectorAll(".reselect-search-input")),v.choiceHeight=v.options.choiceHeight,v.listHeight=v.options.listHeight,v.remotePagination={},v.haveChoices=!1,v.CHOICE_TEMPLATE=angular.element('<li class="reselect-option reselect-option-choice" style="height: {{$options.choiceHeight}}px" ng-click="$options._selectChoice($index, $onClick)"></li>'),v.CHOICE_TEMPLATE.append('<div class="reselect-option-choice-sticky" ng-show="$sticky === true" ng-bind-html="$stickyContent"></div>'),v.CHOICE_TEMPLATE.append('<div class="reselect-option-choice-container" ng-show="!$sticky"></div>'),v.CHOICE_TEMPLATE.attr("ng-class","[{'reselect-option-choice--highlight' : $options.activeIndex === $index, 'reselect-option-choice--selected' : $options.selectedIndex === $index }, cssClass]"),v.CHOICE_TEMPLATE.attr("ng-mouseenter","$options.activeIndex = $index"),v.CHOICE_TEMPLATE.attr("ng-mouseleave","$options.activeIndex = null"),v.stickyChoices=[],v.registerChoices=function(e){angular.forEach(e,function(e){e=angular.element(e);var t={"class":e.attr("class"),$sticky:!0,$stickyContent:e.html()};e.attr("ng-click")&&(t.onClick=e.attr("ng-click")),v.stickyChoices.push(t)})},v.keydown=function(e){var n=e.which;if(n&&!e.shiftKey&&!e.altKey)switch(n){case u.ENTER:t.$emit("reselect.select"),e.stopPropagation(),e.preventDefault();break;case u.SPACE:t.$emit("reselect.select"),e.stopPropagation(),e.preventDefault();break;case u.UP:t.$emit("reselect.previous"),e.stopPropagation(),e.preventDefault();break;case u.DOWN:t.$emit("reselect.next"),e.stopPropagation(),e.preventDefault()}},h.parsedOptions=e.parse(s.options),s.remote?(v.remoteOptions=r(s.remote)(t.$parent),h.DataAdapter=new d(v.remoteOptions,h.parsedOptions),h.DataAdapter.prepareGetData=function(){h.DataAdapter.page=1,h.DataAdapter.pagination={},h.DataAdapter.updateData([]),v.render()}):(h.DataAdapter=new p({},h.parsedOptions),h.DataAdapter.updateData(h.parsedOptions.source(t)),h.DataAdapter.observe=function(){t.$watchCollection(function(){return h.parsedOptions.source(t)},function(e){h.DataAdapter.updateData(e)})}),h.DataAdapter.init(),v.getData=function(e,t){e===!0&&h.DataAdapter.prepareGetData(),v.is_loading=!0,h.DataAdapter.getData(h.search_term).then(function(e){h.search_term?v.render(e.data):(h.DataAdapter.updateData(e.data,t),v.render())}).finally(function(){v.is_loading=!1})},v.loadMore=function(){h.DataAdapter.pagination&&h.DataAdapter.pagination.more&&v.getData(!1,!0)},v.search=i.debounce(function(){v.getData(!0,!1)},300,!1,function(){v.is_loading=!0}),v.LazyDropdown=new n(t,{scopeName:h.parsedOptions.itemName,container:v.$container,list:v.$list,choiceHeight:v.choiceHeight,listHeight:v.listHeight}),v.activeIndex=0,v.selectedIndex=null,v._selectChoice=function(e,n){if(n)r(n)(t.$parent),h.hideDropdown();else{v.selectedIndex=e;var o=e,i={};i[h.parsedOptions.itemName]=v.LazyDropdown.choices[o];var c=angular.copy(h.parsedOptions.modelMapper(i));h.selectValue(c,i[h.parsedOptions.itemName])}},v.bindEventListeners=function(){t.$on("reselect.select",function(){v._selectChoice(v.activeIndex)}),t.$on("reselect.next",function(){var e=v.$container[0].offsetHeight,t=v.$container[0].scrollTop;null!==v.activeIndex?v.activeIndex<h.DataAdapter.data.length-1&&v.activeIndex++:v.activeIndex=0,t+e<v.activeIndex*v.choiceHeight+v.choiceHeight&&(v.$container[0].scrollTop=v.activeIndex*v.choiceHeight-e+v.choiceHeight)}),t.$on("reselect.previous",function(){var e=v.$container[0].scrollTop;v.activeIndex?v.activeIndex--:v.activeIndex=0,e>v.activeIndex*v.choiceHeight&&(v.$container[0].scrollTop=e-v.choiceHeight)}),v.$search.on("keydown",function(e){e.which===u.SPACE&&e.stopPropagation()})},v.render=function(e){if(v.LazyDropdown.choices=e||h.DataAdapter.data,v.LazyDropdown.choices=v.stickyChoices.concat(v.LazyDropdown.choices),v.LazyDropdown.choices&&v.LazyDropdown.choices.length>=0){v.haveChoices=!!v.LazyDropdown.choices.length;var t=v.LazyDropdown.renderContainer();v.LazyDropdown._calculateLazyRender(!0),v.LazyDropdown.choices&&v.LazyDropdown.choices.length&&t.containerHeight>=t.choiceHeight&&v.loadMore()}else v.haveChoices=!1},v.bindEventListeners()}]}}]),e.directive("reselectPlaceholder",function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"templates/reselect.placeholder.tpl.html"}}),e.directive("reselectSelection",function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"templates/reselect.selection.tpl.html",scope:{},link:function(e,t,n,o,i){i(e,function(e){t.append(e)})},controller:["$scope",function(e){e.$selection=null,e.$choice=null,e.$on("reselect.renderselection",function(t,n){angular.extend(e,n)})}]}}),e.service("ChoiceParser",["$parse",function(e){var t=this;t.parse=function(t){var n;if(n=t.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),!n)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",t);var o=n[5],i="";if(n[3]){o=n[5].replace(/(^\()|(\)$)/g,"");var c=n[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/);c&&c[1].trim()&&(i=c[1],o=o.replace(i,""))}return{itemName:n[4]||n[2],keyName:n[3],source:e(o),sourceItem:o,filters:i,trackByExp:n[6],modelMapper:e(n[1]||n[4]||n[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}}}]),e.run(["$rootScope","$http",function(e){e.$safeApply=function(e){var t=this.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():this.$apply(e)}}]),e.factory("ReselectUtils",function(){var e={debounce:function(e,t,n,o){var i;return function(){var c=this,s=arguments,r=function(){i=null,n||e.apply(c,s)},a=n&&!i;clearTimeout(i),i=setTimeout(r,t),a&&e.apply(c,s),o&&o.apply(c,s)}}};return e}),e.filter("rshighlight",["$sce",function(e){return function(t,n){var o,i,c,s="reselect-text-match";return c=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),t?n?(t.match&&t.replace||(t=t.toString()),i=t.match(c),o=i?t.replace(c,'<span class="'+s+'">'+i[0]+"</span>"):t,e.trustAsHtml(o)):t:void 0}}]),e.directive("focusOn",["$timeout",function(e){return{restrict:"A",link:function(t,n,o){t.$on(o.focusOn,function(){e(function(){n[0].focus()})})}}}]),e.directive("blurOn",["$timeout",function(e){return{restrict:"A",link:function(t,n,o){t.$on(o.blurOn,function(){e(function(){n[0].blur()})})}}}]),angular.module("reselect.templates",[]).run(["$templateCache",function(e){e.put("templates/lazy-container.tpl.html",'<div class="reselect-dropdown"><div class="reselect-options-container"><div class="reselect-option reselect-option-choice" ng-show="!$reselect.choices.length">No Options</div><ul class="reselect-options-list"></ul></div></div>'),e.put("templates/reselect-no-choice.directive.tpl.html",'<div class="reselect-no-choice" ng-transclude=""></div>'),e.put("templates/reselect.directive.tpl.html",'<div class="reselect-container reselect" tabindex="0" focus-on="reselect.input.focus" blur-on="reselect.input.blur" ng-keydown="$reselect.handleKeyDown($event)"><input type="hidden" value="{{ngModel}}"><div class="reselect-selection-container" ng-class="{\'reselect-selection--active\' : $reselect.opened }" ng-click="$reselect.toggleDropdown()"><div class="reselect-rendered reselect-rendered-selection" ng-show="$reselect.value"><div class="reselect-selection" reselect-selection=""><span ng-bind="$selection"></span></div></div><div class="reselect-rendered reselect-rendered-placeholder" ng-show="!$reselect.value"><div class="reselect-placeholder" reselect-placeholder="">Please select an option</div></div><div class="reselect-arrow-container"><div class="reselect-arrow"></div></div></div><a href="javascript:;" class="reselect-clear-button" ng-if="$reselect.options.allowClear && $reselect.value" ng-click="$reselect.clearValue()">&times;</a><div class="reselect-dropdown" ng-class="{\'reselect-dropdown--opened\' : $reselect.opened }"></div></div>'),e.put("templates/reselect.options.directive.tpl.html",'<div class="reselect-choices" ng-keydown="$options.keydown($event)"><div class="reselect-search-container"><input class="reselect-search-input" tabindex="-1" type="text" focus-on="reselect.search.focus" placeholder="Type to search..." ng-model="$reselect.search_term" ng-change="$options.search()"></div><div class="reselect-option-loader" ng-show="$options.is_loading"></div><div class="reselect-options-container" ng-class="{\'reselect-options-container--autoheight\': !$options.LazyDropdown.choices.length && !$options.is_loading }" trigger-at-bottom="$options.loadMore()"><ul class="reselect-options-list" ng-show="$options.LazyDropdown.choices.length"></ul><div class="reselect-static-option reselect-empty-container" ng-show="!$options.haveChoices && !$options.is_loading"><div class="reselect-no-choice" reselect-no-choice=""><div class="reselect-option reselect-option--static reselect-option-choice">{{$options.options.noOptionsText}}</div></div></div><div class="reselect-option reselect-static-option reselect-option-loading" ng-show="$options.is_loading">Loading More...</div></div></div>'),e.put("templates/reselect.placeholder.tpl.html",'<div class="reselect-placeholder" ng-transclude=""></div>'),e.put("templates/reselect.selection.tpl.html",'<div class="reselect-selection"></div>')}]),e.filter("rsPropsFilter",function(){return function(e,t){var n=[];return angular.isArray(e)?e.forEach(function(e){for(var o=!1,i=Object.keys(t),c=0;c<i.length;c++){if(angular.isUndefined(t[s])){o=!0;break}var s=i[c],r=t[s].toLowerCase();if(-1!==e[s].toString().toLowerCase().indexOf(r)){o=!0;break}}o&&n.push(e)}):n=e,n}}),e.constant("KEYS",{BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46})}).apply(this);