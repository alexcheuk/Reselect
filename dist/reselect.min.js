/*!
 * reselect
 * https://github.com/alexcheuk/Reselect
 * Version: 0.0.1 - 2016-04-01T20:08:59.065Z
 * License: MIT
 */
!function(){"use strict";var e=angular.module("Reselect",["reselect.templates"]);e.service("ReselectDataAdapter",["$q",function(e){var t=function(){this.data=[]};return t.prototype.observe=function(){console.error("Not implemented")},t.prototype.prepareGetData=function(){},t.prototype.getData=function(){var t=e.defer();return t.resolve({data:this.data}),t.promise},t.prototype.updateData=function(e,t){return this.data=t===!0?this.data.concat(e):e,this.data},t.prototype.init=function(){this.observe(this.updateData.bind(this))},t}]),e.service("ReselectAjaxDataAdapter",["$http",function(e){var t=function(e){this.data=[],this.page=1,this.pagination={},this.options=e};return t.prototype.observe=function(){},t.prototype.prepareGetData=function(){},t.prototype.getData=function(t){var n=this,o=this.options.params({page:this.page,search_term:t},n.pagination);return e.get(this.options.endpoint,{params:o}).then(function(e){return e.data}).then(this.options.onData).then(function(e){return e.pagination?(n.pagination=e.pagination,e.pagination.more&&(n.page+=1)):n.pagination=null,e})},t.prototype.updateData=function(e,t,n){return e=n===!0?e.concat(t):t},t.prototype.init=function(){},t}]);var t=function(e,t){var n=e.reselect=this;n.options=angular.extend({},e.reselectOptions,t),n.rendered_placeholder=n.options.placeholderTemplate()};t.$inject=["$scope","reselectDefaultOptions"],angular.module("reselect.controller",[]).controller("reselect.directive.ctrl",t),e.value("reselectDefaultOptions",{placeholderTemplate:function(){return"Select an option"},selectionTemplate:angular.element('<div><span ng-bind="$selection.text"></span></div>')}).directive("reselect",["$compile",function(e){return{restrict:"AE",templateUrl:"templates/reselect.directive.tpl.html",require:["^reselect","^ngModel"],transclude:!0,replace:!0,scope:{ngModel:"=",reselectOptions:"="},compile:function(t,n,o){return function(t,n,i,r){var c=r[0],a=null;o(t,function(e){a=e,n.append(e)}).detach(),a=angular.element("<div>").append(a);var s=a[0].querySelectorAll(".reselect-choices, [reselect-choices]"),l=a[0].querySelectorAll(".reselect-selection, [reselect-selection]");l=l.length?l:c.options.selectionTemplate.clone(),angular.element(n[0].querySelectorAll(".reselect-dropdown")).append(s),angular.element(n[0].querySelectorAll(".reselect-rendered-selection")).append(l),c.transcludeCtrls.$ReselectChoice=angular.element(s).controller("reselectChoices"),e(l)(c.selection_scope)}},controllerAs:"$reselect",controller:["$scope","$element","reselectDefaultOptions","$timeout",function(e,t,n){var o=this,i=t.controller("ngModel");return o.options=angular.extend({},e.reselectOptions,n),o.value=null,o.opened=!1,o.transcludeCtrls={},o.rendered_placeholder=null,o.renderPlaceholder=function(){o.rendered_placeholder=o.options.placeholderTemplate()},o.selection_scope=e.$new(),o.selection_scope.$selection=null,o.rendered_selection=null,o.renderSelection=function(e){o.selection_scope.$selection=e},o.selectValue=function(e){i.$setViewValue(e),o.value=e,o.renderSelection(o.value),o.hideDropdown()},o.parsedOptions=null,o.choices=[],o.toggleDropdown=function(){o.opened?o.hideDropdown():o.showDropdown()},o.showDropdown=function(){o.opened=!0,o.transcludeCtrls.$ReselectChoice.getData(!0)},o.hideDropdown=function(){o.opened=!1},o.initialize=function(){o.renderPlaceholder()},o.initialize(),o}]}}]),e.service("LazyScroller",["LazyContainer","$compile",function(e,t){var n=function(e,t){var n=this;n.options=angular.extend({},t),n.$scope=e,n.$container=n.options.container,n.$list=n.options.list,n.choices=[],n.lazyContainers=[],n.numLazyContainers=Math.ceil(n.options.listHeight/n.options.choiceHeight)+2,n.lastCheck=null,n.lastScrollTop=null};return n.prototype.renderContainer=function(){var e=this,t=e.choices.length*e.options.choiceHeight,n=t>e.options.listHeight?e.options.listHeight:t;return e.$container.css("height",(n||e.options.choiceHeight)+2+"px"),e.$list.css("height",t+"px"),{choiceHeight:t,containerHeight:n}},n.prototype.bindScroll=function(){var e=this;e.$container.on("scroll",function(){window.requestAnimationFrame(function(){e._calculateLazyRender()})})},n.prototype._shouldRender=function(e){var t=this;return"number"==typeof t.lastCheck&&e<=t.lastCheck+(t.options.choiceHeight-t.lastCheck%t.options.choiceHeight)&&e>=t.lastCheck-t.lastCheck%t.options.choiceHeight},n.prototype._calculateLazyRender=function(e){var t=this,n=e===!0?t.lastScrollTop:t.$container[0].scrollTop;if(t.lastScrollTop=n,e===!0||!t._shouldRender()){var o=[],i=[];angular.forEach(t.lazyContainers,function(e){var r=e.index*t.options.choiceHeight||0;null===e.index||r<n-t.options.choiceHeight||r>n+t.options.listHeight+t.options.choiceHeight?(e.element.addClass("inactive").removeClass("active"),i.push(e)):(e.element.addClass("active").removeClass("inactive"),o.push(e))});var r=o.map(function(e){return e.index}),c=Math.floor(n/t.options.choiceHeight);c=0>c?0:c;var a=Math.ceil((n+t.options.listHeight)/t.options.choiceHeight);a=a>=t.choices.length?t.choices.length:a;for(var s=c;a>s;s++)if(!(r.indexOf(s)>=0)){var l=i.shift();l&&(l.element.addClass("active").removeClass("inactive"),l.index=s,l.render(t.options.choiceHeight),angular.extend(l.scope,{$containerId:l.containerId,$index:s}),angular.extend(l.scope.$choice,t.choices[s]))}t.$scope.$evalAsync(),t.lastCheck=Math.floor(n/t.options.choiceHeight)*t.options.choiceHeight}},n.prototype.initialize=function(n){for(var o=this,i=0;i<o.numLazyContainers;i++){var r=n.clone(),c=o.$scope.$new();c.$choice={},t(r)(c),o.lazyContainers.push(new e({containerId:i,element:r,scope:c})),o.$list.append(r)}o.bindScroll()},n}]),e.service("LazyContainer",[function(){var e=function(e){var t=this;t.containerId=null,t.element=null,t.index=null,t.scope=null,angular.extend(t,e)};return e.prototype.render=function(e){var t=this;(t.element||null!==t.index)&&t.element.css("top",t.index*e+"px")},e}]),angular.module("reselect.templates",[]).run(["$templateCache",function(e){e.put("templates/lazy-container.tpl.html",'<div class="reselect-dropdown"><div class="reselect-options-container"><div class="reselect-option reselect-option-choice" ng-show="!$reselect.choices.length">No Options</div><ul class="reselect-options-list"></ul></div></div>'),e.put("templates/reselect.choice.tpl.html",""),e.put("templates/reselect.directive.tpl.html",'<div class="reselect-container reselect"><input type="hidden" value="{{ngModel}}"><div class="reselect-selection" ng-class="{\'reselect-selection--active\' : $reselect.opened }" ng-click="$reselect.toggleDropdown()"><div class="reselect-rendered reselect-rendered-selection" ng-show="$reselect.value"></div><div class="reselect-rendered reselect-rendered-placeholder" ng-show="!$reselect.value" ng-bind="$reselect.rendered_placeholder"></div><div class="reselect-arrow-container"><div class="reselect-arrow"></div></div></div><div class="reselect-dropdown" ng-class="{\'reselect-dropdown--opened\' : $reselect.opened }"></div></div>'),e.put("templates/reselect.options.directive.tpl.html",'<div class="reselect-choices"><div class="reselect-options-container" trigger-at-bottom="$options.loadMore()"><div class="reselect-option reselect-option-choice" ng-show="!$options.choices.length">No Options</div><ul class="reselect-options-list" ng-show="$options.choices.length"></ul></div></div>')}]),e.value("reselectChoicesOptions",{}),e.directive("triggerAtBottom",["$parse",function(e){function t(e,t,n){var o;return function(){var i=this,r=arguments,c=function(){o=null,n||e.apply(i,r)},a=n&&!o;clearTimeout(o),o=setTimeout(c,t),a&&e.apply(i,r)}}var n=function(e){return e=e[0]||e,isNaN(e.offsetHeight)?e.document.documentElement.clientHeight:e.offsetHeight};return{restrict:"A",link:function(o,i,r){function c(){(n(i)+i[0].scrollTop!==0||0!==i[0].scrollHeight)&&(n(i)+i[0].scrollTop>=i[0].scrollHeight-30&&s(),a=!1)}var a=!1,s=t(function(){e(r.triggerAtBottom)(o)},300);i.on("scroll",function(){a||(window.requestAnimationFrame?window.requestAnimationFrame(c):setTimeout(c,300),a=!0)}),c()}}}]),e.directive("reselectChoices",["ChoiceParser","$compile","LazyScroller","LazyContainer",function(e,t,n){return{restrict:"AE",templateUrl:"templates/reselect.options.directive.tpl.html",require:["reselectChoices","?^reselect"],transclude:!0,replace:!0,compile:function(e,t){if(!t.options&&!t.remote)throw new Error('"reselect-options" directive requires the [options] or [remote] attribute.');return function(e,t,n,o,i){{var r=o[0];o[1]}i(function(e){r.CHOICE_TEMPLATE.append(e)}),r.LazyDropdown.initialize(r.CHOICE_TEMPLATE),r.LazyDropdown.renderContainer()}},controllerAs:"$options",controller:["$scope","$element","$attrs","$parse","$http","ReselectDataAdapter","ReselectAjaxDataAdapter",function(t,o,i,r,c,a,s){var l=this;l.element=o[0],l.$container=angular.element(l.element.querySelectorAll(".reselect-options-container")),l.$list=angular.element(l.element.querySelectorAll(".reselect-options-list")),l.choiceHeight=36,l.listHeight=300,l.search_term="",l.choices=[],l.remotePagination={},l.CHOICE_TEMPLATE=angular.element('<li class="reselect-option reselect-option-choice" ng-click="$options._selectChoice($containerId)"></li>'),l.CHOICE_TEMPLATE.attr("ng-class","{'reselect-option-choice--highlight' : $options.activeIndex === $index }"),l.CHOICE_TEMPLATE.attr("ng-mouseenter","$options.activeIndex = $index"),l.CHOICE_TEMPLATE.attr("ng-mouseleave","$options.activeIndex = null");var p=o.controller("reselect");l.DataAdapter=null,i.options?(l.parsedOptions=e.parse(i.options),l.DataAdapter=new a,l.DataAdapter.observe=function(){t.$watchCollection(function(){return l.parsedOptions.source(t.$parent)},function(e){l.choices=l.DataAdapter.updateData(e)})}):i.remote&&(l.parsedOptions=r(i.remote)(t.$parent),l.DataAdapter=new s(l.parsedOptions),l.DataAdapter.prepareGetData=function(){l.choices=l.DataAdapter.updateData(l.choices,[]),l.render()}),l.DataAdapter.init(),l.getData=function(e,t){e===!0&&l.DataAdapter.prepareGetData(),l.DataAdapter.getData(l.search_term).then(function(e){l.choices=l.DataAdapter.updateData(l.choices,e.data,t),l.render()})},l.loadMore=function(){l.getData(!1,!0)},l.LazyDropdown=new n(t,{container:l.$container,list:l.$list,choiceHeight:36,listHeight:300}),l.activeIndex=null,l._setActiveIndex=function(e){l.activeIndex=e},l._selectChoice=function(e){var t=angular.copy(l.LazyDropdown.lazyContainers[e].scope.$eval(i.value));p.selectValue(t)},l.$parent=o.parent(),l.render=function(e){l.LazyDropdown.choices=e||l.choices;var t=l.LazyDropdown.renderContainer();l.LazyDropdown._calculateLazyRender(!0),l.LazyDropdown.choices&&l.LazyDropdown.choices.length&&t.containerHeight>=t.choiceHeight&&l.loadMore()}}]}}]),e.service("ChoiceParser",["$parse",function(e){var t=this;t.parse=function(t){var n;if(n=t.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),!n)throw uiSelectMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",t);var o=n[5],i="";if(n[3]){o=n[5].replace(/(^\()|(\)$)/g,"");var r=n[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/);r&&r[1].trim()&&(i=r[1],o=o.replace(i,""))}return{itemName:n[4]||n[2],keyName:n[3],source:e(o),filters:i,trackByExp:n[6],modelMapper:e(n[1]||n[4]||n[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}}}])}();